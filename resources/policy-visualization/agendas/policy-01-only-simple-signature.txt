At 0 do StartIrond();

At 3 do StartVisitmetaDataservice();

At 4 do Break(
	message => irond and VisITMeta dataservice started);

At 5 do StartVisitmetaGUI();

At 6 do Break(
	message => VisITMeta GUI started);

At 7 do InitPdpInfrastructure(
	pdp => freeradius-pdp,
	pdp-ip-address => 10.0.0.2,
	iptables => iptables,
	iptables-ip-address => 10.0.0.3,
	switch => switch,
	switch-ip-address => 10.0.0.1,
	ifmap-user => radius,
	ifmap-pass => radius);
	
At 7 do DeviceIp(
	mode => update,
	device => dhcp-server,
	ip-address => 10.0.0.5,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 8 do DiscoveredBy(
	device => dhcp-server,
	id-type => ipv4,
	identifier => 10.0.0.2,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 9 do DiscoveredBy(
	device => dhcp-server,
	id-type => ipv4,
	identifier => 10.0.0.3,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 10 do DiscoveredBy(
	device => dhcp-server,
	id-type => ipv4,
	identifier => 10.0.0.1,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 11 do DiscoveredBy(
	device => dhcp-server,
	id-type => ipv4,
	identifier => 10.0.0.4,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 12 do Break(
	message => Initial infrastructure published);

At 13 do PolicyRule(
	device => irondetect,
	rule => 1:inofficalApp,
	ip => 10.0.0.4,
	action => 1:appAlert,
	action-value => alert.name set to Inofficial App Detected,
	condition => 1:conInofficialApp,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);
	
At 14 do PolicySignature(
	condition => 1:conInofficialApp,
	signature => 1:sigInofficalApp,
	signature-value => smartphone.android.app.installer IS NOT com.android.vending AND smartphone.android.app.isrunning IS true,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);

At 15 do Break(
	message => Policy of irondetect published);

At 16 do DeviceConnects(
	access-request => ar:1,
	pdp => freeradius-pdp,
	mac => aa:bb:cc:dd:ee:ff,
	ip-address => 10.0.0.50,
	ifmap-user-pdp => radius,
	ifmap-pass-pdp => radius,
	ifmap-user-dhcp => dhcp,
	ifmap-pass-dhcp => dhcp);

At 17 do DeviceIp(
	mode => update,
	device => smartphone,
	ip-address => 10.0.0.50,
	ifmap-user => dhcp,
	ifmap-pass => dhcp);

At 18 do Break(
	message => Smartphone connected);

At 19 do SingleSmartphoneFeatureDetected(
	access-request => ar:1,
	device => smartphone,
	feature-id => smartphone.android.app.installer,
	feature-value => foo.bar.something,
	feature-type => qualified,
	ifmap-user => android,
	ifmap-pass => android);

At 20 do Break(
	message => Alert is generated by irondetect);

At 21 do SingleSmartphoneFeatureDetected(
	access-request => ar:1,
	device => smartphone,
	feature-id => alert,
	feature-value => Inofficial App Detected,
	feature-type => qualified,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);

At 22 do Break(
	message => Connect policy rule subgraph to actual sensor metadata);

At 23 do PolicyCreateRuleInstance(
	rule => 1:inofficalApp,
	rule-instance => 1,
	signature => 1:sigInofficalApp,
	signature-value => smartphone.android.app.installer IS NOT com.android.vending AND smartphone.android.app.isrunning IS true,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);

At 24 do PolicyConnectRuleInstanceToCategory(
	rule-instance => 1,
	category => alert,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);

At 25 do Break(
	message => will now purge all data);

At 26 do PurgeMetadata(
	ifmap-user => irondetect,
	ifmap-pass => irondetect);
At 26 do PurgeMetadata(
	ifmap-user => dhcp,
	ifmap-pass => dhcp);
At 26 do PurgeMetadata(
	ifmap-user => android,
	ifmap-pass => android);
At 26 do PurgeMetadata(
	ifmap-user => radius,
	ifmap-pass => radius);

At 27 do Break(
	message => Agenda finished);
